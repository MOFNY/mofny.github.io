$(document).ready(function(){var o=$("html, body"),t=0,e=500,s=$(".yearGroup"),n=$(".buttonGroup"),l=$(".hideGroup"),i=$(".closeBar"),a=$("#allCloseBar"),r=$("#menu-button"),c=$("#primary-nav"),f=[],p=[],u=!1,d=$("#hideInfo"),h=$(".overallInsertsTotal"),m=$("#revealAllButton"),g=$(".totalGroup"),w=$(".overallTotalGroup"),T=$("li"),v=[],y=[],k=$(".red"),C=$(s).find(T).length-$(s).find(k).length,x=$(".arrow-down"),b=$(".arrow-up");function E(){d.slideToggle("slow")}function I(){$(window).scrollTop()>$("#closeArea").offset().top?a.css({position:"fixed"}):a.css({position:"relative",top:"0",zIndex:"1"})}function O(o,t,e){return o>=t&&o<=e}function A(){o.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(t){(t.which>0||"mousedown"===t.type||"mousewheel"===t.type)&&o.stop().unbind("scroll mousedown DOMMouseScroll mousewheel keyup")})}x.hide(),b.hide(),h.on("click",function(){E()}),$.each(n,function(r,g){$(this).click(function(){if(window.addEventListener("scroll",I),setTimeout(function(){$(n[r]).css({opacity:"0",transform:"scale(0.2)",width:"0"}),$(n[0]).css({opacity:"1",transform:"scale(1)",width:"50%"})},200),sortElements=function(o,t){return o.text()<t.text()?-1:o.text()>t.text()?1:0},sortElements2=function(o,t){return o<t?-1:o>t?1:0},"All Years"==$(this).text()){u=!u;for(var g=1;g<n.length;g++)u&&0==$(s[g-1]).height()?$.when($(n[g]).triggerHandler("click")).done(function(){o.animate({scrollTop:m.offset().top+100},{duration:1e3,easing:"easeOutQuad"}),A()}):!u&&$(s[g-1]).height()>0&&$.when($(n[g]).triggerHandler("click")).done(function(){o.animate({scrollTop:m.offset().top+30},{duration:0,easing:"easeOutQuad"}),A()})}$(l[r-1]).slideToggle(e,function(){if(t=800,o.animate({scrollTop:$(s[r-1]).offset().top-100},{duration:t,easing:"easeOutQuad"}),setTimeout(function(){$(n[r]).toggleClass("float")},800),$(s[r-1]).height()>0){var e;a.css({zIndex:"1",height:"80px"}),c.addClass("primary-nav--float-bar-is-open"),A(),d.hide("slow"),$(h).off("click"),$(h).addClass("overallInsertsTotal2").attr("data-content",""),f.splice(0,0,$(n[r])),p.splice(0,0,$(n[r]).text()),f.sort(sortElements),p.sort(sortElements2);$(n[r]).hover(function(){A();var t=$(s[r-1]),l=t.offset(),i=l.top,a=(l.left,i+$(s[r-1]).outerHeight()),c=$(window).width()-t.width();c=Math.abs(l.left-c);var p=0;O($(n[r]).offset().top,$(s[r-1]).position().top,a)?p=500:$(n[r]).offset().top<=$(s[r-1]).offset().top&&1==f.length?p=500:$(n[r]).offset().top>495&&$(n[r]).offset().top<1700&&!O($(n[r]).offset().top,$(s[r-1]).position().top,a)?p=1e3:$(n[r]).offset().top>1701&&$(n[r]).offset().top<3e3&&!O($(n[r]).offset().top,$(s[r-1]).position().top,a)?p=1500:$(n[r]).offset().top>3001&&$(n[r]).offset().top<6e3&&!O($(n[r]).offset().top,$(s[r-1]).position().top,a)?p=2e3:$(n[r]).offset().top>6001&&!O($(n[r]).offset().top,$(s[r-1]).position().top,a)?(p=2500,console.log("the slowest")):p=500,$(n[r]).hasClass("float")||(p=0,console.log("doesnt have class")),e=setTimeout(function(){o.animate({scrollTop:$(s[r-1]).offset().top},p,"easeInOutCubic")},1500)},function(){clearTimeout(e)}),$.each(f,function(o,t){$(f[o]).appendTo(a),console.log(f.length),x.show(),b.show(),x.prependTo(a),b.appendTo(a),f.length>7?(setTimeout(function(){$(t).css({opacity:"0.9",width:"7%",transform:"scale(1)"})},1200),f.sort(sortElements),p.sort(sortElements2)):(setTimeout(function(){$(t).css({opacity:"0.9",transform:"scale(1)",width:"10%"})},1200),f.sort(sortElements),p.sort(sortElements2))})}0==$(s[r-1]).height()&&(console.log("yes"),$(n[r]).css({width:"50%",opacity:"1",transform:"scale(1)"}),f.splice($.inArray($(n[r]).text(),p),1),p.splice($.inArray($(n[r]).text(),p),1),$(n[r]).appendTo($(i[r]))),setTimeout(function(){0==f.length&&(A(),window.removeEventListener("scroll",I),$(n[r]).css({width:"50%",opacity:"1",transform:"scale(1)"}),a.css({zIndex:"1",height:"0"}),c.removeClass("primary-nav--float-bar-is-open"),x.fadeOut("slow"),b.fadeOut("slow"),h.on("click",function(){E()}),$(h).removeClass("overallInsertsTotal2"))},100)}),$(n[r]).toggleClass("openClose"),$(n[r]).toggleClass("openClose2")})}),$.each(s,function(o,t){var e=$(s[o]).find(T).length,l=$(s[o]).attr("data-value");v.push(l);var i=e-$(s[o]).find(k).length;y.push(i);var a="Completion Stats: "+i+"/"+l+" or "+parseFloat((100*i/l).toFixed(1))+"%";$(g[o]).text(a);$(n[o+1]).attr("title",a)});var F=0;$.each(v,function(){F+=parseFloat(this)||0});var G=100*C/F;function M(o){$(".details-year").attr("open",o)}$(w).text(C+"/"+F+" or "+parseFloat(G.toFixed(1))+"%"),x.click(function(){o.animate({scrollTop:$(document).height()},600)}),b.click(function(){o.animate({scrollTop:m.offset().top-75},500)}),r.on("click",function(){$(this).toggleClass("menu-is-open"),c.on("webkitTransitionEnd transitionend").toggleClass("primary-nav--is-visible")}),$(".arrow-up2").click(function(){$("html, body").animate({scrollTop:0},700,"easeInOutCubic")}),$("#open-all-years").on("click",function(){M(""),localStorage.removeItem("keepClosed")}),$("#close-all-years").on("click",function(){M(!1),localStorage.setItem("keepClosed",!0)}),$(".details-year").on("toggle",function(){$this=$(this),$this.attr("open")||$("html, body").animate({scrollTop:$this.offset().top-75},0)}),$("body").on("click",function(){$this=$(this),scrollTop=$(document).scrollTop(),$this.css("margin-top",scrollTop+"px"),$this.addClass("lock"),window.scrollTo(0,1)})});