$(document).ready(function(){function y(){m.slideToggle("slow")}function A(){$(window).scrollTop()>$("#closeArea").offset().top?i.css({position:"fixed"}):i.css({position:"relative",top:"0",zIndex:"1"})}function B(a,b,c){return a>=b&&a<=c}function C(){b.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(a){(a.which>0||"mousedown"===a.type||"mousewheel"===a.type)&&b.stop().unbind("scroll mousedown DOMMouseScroll mousewheel keyup")})}var b=$("html, body"),c=0,d=500,e=$(".yearGroup"),f=$(".buttonGroup"),g=$(".hideGroup"),h=$(".closeBar"),i=$("#allCloseBar"),j=[],k=[],l=!1,m=$("#hideInfo"),n=$(".overallInsertsTotal"),o=$("#revealAllButton"),p=$(".totalGroup"),q=$(".overallTotalGroup"),r=$("li"),s=[],t=[],u=$(".red"),v=$(e).find(r).length-$(e).find(u).length,w=$(".arrow-down"),x=$(".arrow-up");w.hide(),x.hide(),n.on("click",function(){y()}),$.each(f,function(a,p){$(this).click(function(){if(window.addEventListener("scroll",A),setTimeout(function(){$(f[a]).css({opacity:"0",transform:"scale(0.2)",width:"0"}),$(f[0]).css({opacity:"1",transform:"scale(1)",width:"50%"})},200),sortElements=function(a,b){return a.text()<b.text()?-1:a.text()>b.text()?1:0},sortElements2=function(a,b){return a<b?-1:a>b?1:0},"All Years"==$(this).text()){l=!l;for(var p=1;p<f.length;p++)l&&0==$(e[p-1]).height()?$.when($(f[p]).triggerHandler("click")).done(function(){b.animate({scrollTop:o.offset().top+100},{duration:1e3,easing:"easeOutQuad"}),console.log("Close"),C()}):!l&&$(e[p-1]).height()>0&&$.when($(f[p]).triggerHandler("click")).done(function(){b.animate({scrollTop:o.offset().top+30},{duration:0,easing:"easeOutQuad"}),console.log("Open"),C()})}$(g[a-1]).slideToggle(d,function(){if(c=800,b.animate({scrollTop:$(e[a-1]).offset().top-100},{duration:c,easing:"easeOutQuad"}),setTimeout(function(){$(f[a]).toggleClass("float")},800),$(e[a-1]).height()>0){i.css({zIndex:"1",height:"80px"}),C(),m.hide("slow"),$(n).off("click"),$(n).addClass("overallInsertsTotal2").attr("data-content",""),j.splice(0,0,$(f[a])),k.splice(0,0,$(f[a]).text()),j.sort(sortElements),k.sort(sortElements2);var d,g=1500;$(f[a]).hover(function(){C();var c=$(e[a-1]),h=c.offset(),i=h.top,l=(h.left,i+$(e[a-1]).outerHeight()),m=$(window).width()-c.width();m=Math.abs(h.left-m);var n=0;B($(f[a]).offset().top,$(e[a-1]).position().top,l)?n=500:$(f[a]).offset().top<=$(e[a-1]).offset().top&&1==j.length?n=500:$(f[a]).offset().top>495&&$(f[a]).offset().top<1700&&!B($(f[a]).offset().top,$(e[a-1]).position().top,l)?n=1e3:$(f[a]).offset().top>1701&&$(f[a]).offset().top<3e3&&!B($(f[a]).offset().top,$(e[a-1]).position().top,l)?n=1500:$(f[a]).offset().top>3001&&$(f[a]).offset().top<6e3&&!B($(f[a]).offset().top,$(e[a-1]).position().top,l)?n=2e3:$(f[a]).offset().top>6001&&!B($(f[a]).offset().top,$(e[a-1]).position().top,l)?(n=2500,console.log("the slowest")):n=500,$(f[a]).hasClass("float")||(n=0,console.log("doesnt have class")),d=setTimeout(function(){b.animate({scrollTop:$(e[a-1]).offset().top},n,"easeInOutCubic")},g)},function(){clearTimeout(d)}),$.each(j,function(a,b){$(j[a]).appendTo(i),console.log(j.length),w.show(),x.show(),w.prependTo(i),x.appendTo(i),j.length>7?(setTimeout(function(){$(b).css({opacity:"0.9",width:"7%",transform:"scale(1)"})},1200),j.sort(sortElements),k.sort(sortElements2)):(setTimeout(function(){$(b).css({opacity:"0.9",transform:"scale(1)",width:"10%"})},1200),j.sort(sortElements),k.sort(sortElements2))})}0==$(e[a-1]).height()&&(console.log("yes"),$(f[a]).css({width:"50%",opacity:"1",transform:"scale(1)"}),j.splice($.inArray($(f[a]).text(),k),1),k.splice($.inArray($(f[a]).text(),k),1),$(f[a]).appendTo($(h[a]))),setTimeout(function(){0==j.length&&(C(),window.removeEventListener("scroll",A),$(f[a]).css({width:"50%",opacity:"1",transform:"scale(1)"}),i.css({zIndex:"1",height:"0"}),w.fadeOut("slow"),x.fadeOut("slow"),n.on("click",function(){y()}),$(n).removeClass("overallInsertsTotal2"))},100)}),$(f[a]).toggleClass("openClose"),$(f[a]).toggleClass("openClose2")})}),$.each(e,function(a,b){var c=$(e[a]).find(r).length,d=$(e[a]).attr("data-value");s.push(d);var g=$(e[a]).find(u).length,h=c-g;t.push(h);var i=100*h/d,j="Completion Stats: "+h+"/"+d+" or "+parseFloat(i.toFixed(1))+"%";$(p[a]).text(j);$(f[a+1]).attr("title",j)});var D=0;$.each(s,function(){D+=parseFloat(this)||0});var E=100*v/D;$(q).text(v+"/"+D+" or "+parseFloat(E.toFixed(1))+"%"),w.click(function(){b.animate({scrollTop:$(document).height()},600)}),x.click(function(){b.animate({scrollTop:o.offset().top-75},500)});var F=$("#cd-nav"),G=F.find("#cd-main-nav ul");$(".cd-nav-trigger").on("click",function(){$(this).toggleClass("menu-is-open"),G.off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend").toggleClass("is-visible")}),$(".arrow-up2").click(function(){$("html, body").animate({scrollTop:0},700,"easeInOutCubic")})});