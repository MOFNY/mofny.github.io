$(document).ready(function(){function A(){o.slideToggle("slow")}function C(){$(window).scrollTop()>$("#closeArea").offset().top?i.css({position:"fixed"}):i.css({position:"relative",top:"0",zIndex:"1"})}function D(a,b,c){return a>=b&&a<=c}function E(){b.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(a){(a.which>0||"mousedown"===a.type||"mousewheel"===a.type)&&b.stop().unbind("scroll mousedown DOMMouseScroll mousewheel keyup")})}function H(a){$(".details-year").attr("open",a)}var b=$("html, body"),c=0,d=500,e=$(".yearGroup"),f=$(".buttonGroup"),g=$(".hideGroup"),h=$(".closeBar"),i=$("#allCloseBar"),j=$("#menu-button"),k=$("#primary-nav"),l=[],m=[],n=!1,o=$("#hideInfo"),p=$(".overallInsertsTotal"),q=$("#revealAllButton"),r=$(".totalGroup"),s=$(".overallTotalGroup"),t=$("li"),u=[],v=[],w=$(".red"),x=$(e).find(t).length-$(e).find(w).length,y=$(".arrow-down"),z=$(".arrow-up");y.hide(),z.hide(),p.on("click",function(){A()}),$.each(f,function(a,j){$(this).click(function(){if(window.addEventListener("scroll",C),setTimeout(function(){$(f[a]).css({opacity:"0",transform:"scale(0.2)",width:"0"}),$(f[0]).css({opacity:"1",transform:"scale(1)",width:"50%"})},200),sortElements=function(a,b){return a.text()<b.text()?-1:a.text()>b.text()?1:0},sortElements2=function(a,b){return a<b?-1:a>b?1:0},"All Years"==$(this).text()){n=!n;for(var j=1;j<f.length;j++)n&&0==$(e[j-1]).height()?$.when($(f[j]).triggerHandler("click")).done(function(){b.animate({scrollTop:q.offset().top+100},{duration:1e3,easing:"easeOutQuad"}),E()}):!n&&$(e[j-1]).height()>0&&$.when($(f[j]).triggerHandler("click")).done(function(){b.animate({scrollTop:q.offset().top+30},{duration:0,easing:"easeOutQuad"}),E()})}$(g[a-1]).slideToggle(d,function(){if(c=800,b.animate({scrollTop:$(e[a-1]).offset().top-100},{duration:c,easing:"easeOutQuad"}),setTimeout(function(){$(f[a]).toggleClass("float")},800),$(e[a-1]).height()>0){i.css({zIndex:"1",height:"80px"}),k.addClass("primary-nav--float-bar-is-open"),E(),o.hide("slow"),$(p).off("click"),$(p).addClass("overallInsertsTotal2").attr("data-content",""),l.splice(0,0,$(f[a])),m.splice(0,0,$(f[a]).text()),l.sort(sortElements),m.sort(sortElements2);var d;$(f[a]).hover(function(){E();var c=$(e[a-1]),h=c.offset(),i=h.top,k=(h.left,i+$(e[a-1]).outerHeight()),m=$(window).width()-c.width();m=Math.abs(h.left-m);var n=0;D($(f[a]).offset().top,$(e[a-1]).position().top,k)?n=500:$(f[a]).offset().top<=$(e[a-1]).offset().top&&1==l.length?n=500:$(f[a]).offset().top>495&&$(f[a]).offset().top<1700&&!D($(f[a]).offset().top,$(e[a-1]).position().top,k)?n=1e3:$(f[a]).offset().top>1701&&$(f[a]).offset().top<3e3&&!D($(f[a]).offset().top,$(e[a-1]).position().top,k)?n=1500:$(f[a]).offset().top>3001&&$(f[a]).offset().top<6e3&&!D($(f[a]).offset().top,$(e[a-1]).position().top,k)?n=2e3:$(f[a]).offset().top>6001&&!D($(f[a]).offset().top,$(e[a-1]).position().top,k)?(n=2500,console.log("the slowest")):n=500,$(f[a]).hasClass("float")||(n=0,console.log("doesnt have class")),d=setTimeout(function(){b.animate({scrollTop:$(e[a-1]).offset().top},n,"easeInOutCubic")},1500)},function(){clearTimeout(d)}),$.each(l,function(a,b){$(l[a]).appendTo(i),console.log(l.length),y.show(),z.show(),y.prependTo(i),z.appendTo(i),l.length>7?(setTimeout(function(){$(b).css({opacity:"0.9",width:"7%",transform:"scale(1)"})},1200),l.sort(sortElements),m.sort(sortElements2)):(setTimeout(function(){$(b).css({opacity:"0.9",transform:"scale(1)",width:"10%"})},1200),l.sort(sortElements),m.sort(sortElements2))})}0==$(e[a-1]).height()&&(console.log("yes"),$(f[a]).css({width:"50%",opacity:"1",transform:"scale(1)"}),l.splice($.inArray($(f[a]).text(),m),1),m.splice($.inArray($(f[a]).text(),m),1),$(f[a]).appendTo($(h[a]))),setTimeout(function(){0==l.length&&(E(),window.removeEventListener("scroll",C),$(f[a]).css({width:"50%",opacity:"1",transform:"scale(1)"}),i.css({zIndex:"1",height:"0"}),k.removeClass("primary-nav--float-bar-is-open"),y.fadeOut("slow"),z.fadeOut("slow"),p.on("click",function(){A()}),$(p).removeClass("overallInsertsTotal2"))},100)}),$(f[a]).toggleClass("openClose"),$(f[a]).toggleClass("openClose2")})}),$.each(e,function(a,b){var c=$(e[a]).find(t).length,d=$(e[a]).attr("data-value");u.push(d);var g=$(e[a]).find(w).length,h=c-g;v.push(h);var i=100*h/d,j="Completion Stats: "+h+"/"+d+" or "+parseFloat(i.toFixed(1))+"%";$(r[a]).text(j);$(f[a+1]).attr("title",j)});var F=0;$.each(u,function(){F+=parseFloat(this)||0});var G=100*x/F;$(s).text(x+"/"+F+" or "+parseFloat(G.toFixed(1))+"%"),y.click(function(){b.animate({scrollTop:$(document).height()},600)}),z.click(function(){b.animate({scrollTop:q.offset().top-75},500)}),j.on("click",function(){$(this).toggleClass("menu-is-open"),k.on("webkitTransitionEnd transitionend").toggleClass("primary-nav--is-visible")}),$(".arrow-up2").click(function(){$("html, body").animate({scrollTop:0},700,"easeInOutCubic")}),$("#open-all-years").on("click",function(){H("")}),$("#close-all-years").on("click",function(){H(!1)})});